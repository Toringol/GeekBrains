Скорее всего здесь можно сделать 2 изменения:
1) Первое это обобщение клиентов и каналов в структуру для последующего расширения чата
Например, для сделать комнаты для клиентов
2) Второе это закрытие коннекта всех клиентов при закрытие сервера